# μ„λ²„ ν—¬μ¤μ²΄ν¬ Next.js μ•±

1λ¶„λ§λ‹¤ μλ™μΌλ΅ μ„λ²„ μƒνƒλ¥Ό ν™•μΈν•κ³ , μ¤λ¥ λ°μƒ μ‹ μ¬λ™μΌλ΅ μ•λ¦Όμ„ μ „μ†΅ν•λ” Next.js μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤.

## μ£Όμ” κΈ°λ¥

- β… 1λ¶„λ§λ‹¤ μλ™ ν—¬μ¤μ²΄ν¬
- β… μ‹¤μ‹κ°„ μ„λ²„ μƒνƒ λ¨λ‹ν„°λ§ (μ›ν• μΈλ””μΌ€μ΄ν„°: μ΄λ΅μƒ‰/λΉ¨κ°„μƒ‰)
- β… λΉ„μ •μƒ μ§€μ† μ‹κ°„ μ¶”μ  λ° ν‘μ‹
- β… νƒ€μ„λΌμΈ μ‹κ°ν™” (μµκ·Ό 60λ¶„ μ²΄ν¬ κΈ°λ΅)
- β… μ¬λ™ μ•λ¦Ό (μ¤λ¥ λ°μƒ μ‹, λΉ„μ •μƒ μ§€μ† μ‹κ°„ ν¬ν•¨)
- β… μ²΄ν¬ νμ¤ν† λ¦¬ ν™•μΈ
- β… μλ™ ν—¬μ¤μ²΄ν¬ κΈ°λ¥
- π”’ **μ„λ²„ μ‚¬μ΄λ“μ—μ„ μ—”λ“ν¬μΈνΈ λ° μ¬λ™ μ›Ήν›… URL κ΄€λ¦¬** (λ³΄μ• κ°•ν™”)

## μ„¤μΉ λ° μ‹¤ν–‰

### 1. μμ΅΄μ„± μ„¤μΉ

```bash
npm install
```

### 2. ν™κ²½ λ³€μ μ„¤μ •

`env.example` νμΌμ„ `.env.local`λ΅ λ³µμ‚¬ν•κ³  κ°’μ„ μ„¤μ •ν•©λ‹λ‹¤:

```bash
cp env.example .env.local
```

`.env.local` νμΌμ„ μ—΄μ–΄μ„ λ‹¤μ λ³€μλ¥Ό μ„¤μ •ν•©λ‹λ‹¤:

```env
# λ¨λ‹ν„°λ§ν•  GraphQL μ—”λ“ν¬μΈνΈ λ©λ΅
HEALTH_CHECK_ENDPOINTS=https://dev-api.athletec.co.kr/graphql,https://field-link-api.athletec.co.kr/graphql

# μ¬λ™ μ›Ήν›… URL (μ„ νƒμ‚¬ν•­)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/...
```

> β οΈ **μ¤‘μ”**: 
> - `HEALTH_CHECK_ENDPOINTS`μ™€ `SLACK_WEBHOOK_URL`μ€ μ„λ²„ μ‚¬μ΄λ“ ν™κ²½ λ³€μμ΄λ―€λ΅ ν΄λΌμ΄μ–ΈνΈμ— λ…Έμ¶λμ§€ μ•μµλ‹λ‹¤.
> - ν™κ²½ λ³€μλ¥Ό μ„¤μ •ν•μ§€ μ•μΌλ©΄ κΈ°λ³Έκ°’μΌλ΅ λ‘ κ°μ μ—”λ“ν¬μΈνΈκ°€ μ‚¬μ©λ©λ‹λ‹¤.
> - μμ„Έν• μ„¤μ • λ°©λ²•μ€ `ENV_SETUP.md` νμΌμ„ μ°Έκ³ ν•μ„Έμ”.

### 3. κ°λ° μ„λ²„ μ‹¤ν–‰

```bash
npm run dev
```

μ„λ²„κ°€ μ‹μ‘λλ©΄ **μλ™μΌλ΅ λ¨λ‹ν„°λ§μ΄ μ‹μ‘**λ©λ‹λ‹¤. (ν΄λΌμ΄μ–ΈνΈ μ ‘μ† λ¶ν•„μ”)

λΈλΌμ°μ €μ—μ„ `http://localhost:3000`μΌλ΅ μ ‘μ†ν•μ—¬ μƒνƒλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

> π’΅ **λ¨λ‹ν„°λ§μ€ μ„λ²„ μ‚¬μ΄λ“μ—μ„ μƒμ‹ μ‘λ™ν•©λ‹λ‹¤**
> - μ„λ²„κ°€ μ‹μ‘λλ©΄ μλ™μΌλ΅ 1λ¶„λ§λ‹¤ ν—¬μ¤μ²΄ν¬λ¥Ό μν–‰ν•©λ‹λ‹¤
> - ν΄λΌμ΄μ–ΈνΈκ°€ μ‚¬μ΄νΈμ— μ ‘μ†ν•μ§€ μ•μ•„λ„ λ¨λ‹ν„°λ§μ€ κ³„μ† μ‘λ™ν•©λ‹λ‹¤
> - ν”„λ΅ νΈμ—”λ“λ” λ‹¨μν μƒνƒλ¥Ό μ΅°νν•μ—¬ ν‘μ‹ν•λ” μ—­ν• λ§ ν•©λ‹λ‹¤

## μ¬λ™ μ›Ήν›… μ„¤μ • λ°©λ²•

1. [Slack API](https://api.slack.com/apps)μ— μ ‘μ†ν•μ—¬ μƒ μ•±μ„ μƒμ„±ν•©λ‹λ‹¤.
2. "Incoming Webhooks" κΈ°λ¥μ„ ν™μ„±ν™”ν•©λ‹λ‹¤.
3. μ›Ήν›… URLμ„ μƒμ„±ν•κ³  λ³µμ‚¬ν•©λ‹λ‹¤.
4. `.env.local` νμΌμ `SLACK_WEBHOOK_URL`μ— λ¶™μ—¬λ„£μµλ‹λ‹¤.

## μ‚¬μ© λ°©λ²•

1. **ν™κ²½ λ³€μ μ„¤μ •**: `.env.local` νμΌμ— `HEALTH_CHECK_ENDPOINTS`μ™€ `SLACK_WEBHOOK_URL`μ„ μ„¤μ •ν•©λ‹λ‹¤.
2. **μƒνƒ ν™•μΈ**: 
   - **μ΄λ΅μƒ‰ μ›**: μ„λ²„κ°€ μ •μƒ μƒνƒ
   - **λΉ¨κ°„μƒ‰ μ›**: μ„λ²„κ°€ λΉ„μ •μƒ μƒνƒ (λΉ„μ •μƒ μ§€μ† μ‹κ°„ ν‘μ‹)
   - **νμƒ‰ μ›**: μ•„μ§ μ²΄ν¬λμ§€ μ•μ
3. **νƒ€μ„λΌμΈ ν™•μΈ**: κ° μ—”λ“ν¬μΈνΈλ³„λ΅ μµκ·Ό 60λ¶„κ°„μ μ²΄ν¬ κΈ°λ΅μ„ μ›ν• μ μΌλ΅ ν™•μΈν•  μ μμµλ‹λ‹¤.

> π’΅ μ—”λ“ν¬μΈνΈμ™€ μ¬λ™ μ›Ήν›… URLμ€ μ„λ²„ ν™κ²½ λ³€μμ— μ„¤μ •λμ–΄ μμΌλ―€λ΅ UIμ—μ„ μ…λ ¥ν•  ν•„μ”κ°€ μ—†μµλ‹λ‹¤.

## Vercel λ°°ν¬ μ‹ μ£Όμμ‚¬ν•­

Vercelμ€ Serverless ν™κ²½μ΄λ―€λ΅ μ§€μ†μ μΈ λ°±κ·ΈλΌμ΄λ“ μ‘μ—…μ„ μ„ν•΄ **Vercel Cron Jobs**λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.

### Vercel Cron Jobs μ„¤μ •

1. **`vercel.json` νμΌ ν™•μΈ**: ν”„λ΅μ νΈ λ£¨νΈμ— `vercel.json` νμΌμ΄ μƒμ„±λμ–΄ μλ”μ§€ ν™•μΈν•©λ‹λ‹¤.
2. **μλ™ μ„¤μ •**: `vercel.json`μ— λ‹¤μ μ„¤μ •μ΄ ν¬ν•¨λμ–΄ μμµλ‹λ‹¤:
   ```json
   {
     "crons": [
       {
         "path": "/api/cron/health-check",
         "schedule": "*/1 * * * *"
       }
     ]
   }
   ```
3. **Vercel λ€μ‹λ³΄λ“μ—μ„ ν™•μΈ**: 
   - Vercel λ€μ‹λ³΄λ“ β†’ ν”„λ΅μ νΈ β†’ Settings β†’ Cron Jobs
   - Cron Jobμ΄ ν™μ„±ν™”λμ–΄ μλ”μ§€ ν™•μΈ

### λ΅μ»¬ κ°λ° vs Vercel λ°°ν¬

- **λ΅μ»¬ κ°λ°**: `instrumentation.js`κ°€ μλ™μΌλ΅ 1λ¶„λ§λ‹¤ ν—¬μ¤μ²΄ν¬ μν–‰
- **Vercel λ°°ν¬**: Vercel Cron Jobsκ°€ 1λ¶„λ§λ‹¤ `/api/cron/health-check`λ¥Ό νΈμ¶ν•μ—¬ ν—¬μ¤μ²΄ν¬ μν–‰

## μ•λ¦Ό μ •μ±…

- μ¤λ¥ λ°μƒ μ‹ μ¬λ™μΌλ΅ μ•λ¦Όμ΄ μ „μ†΅λ©λ‹λ‹¤.
- μ•λ¦Όμ—λ” λΉ„μ •μƒ μ§€μ† μ‹κ°„μ΄ ν¬ν•¨λ©λ‹λ‹¤ (μ: "3λ¶„ 45μ΄").
- λ™μΌν• μ¤λ¥μ— λ€ν•΄ 5λ¶„ μ΄λ‚΄μ—λ” μ¤‘λ³µ μ•λ¦Όμ„ λ³΄λ‚΄μ§€ μ•μµλ‹λ‹¤.
- μ„λ²„κ°€ μ •μƒ μƒνƒλ΅ λ³µκµ¬λλ©΄ λ‹¤μ μ¤λ¥ λ°μƒ μ‹ λ‹¤μ‹ μ•λ¦Όμ„ λ°›μ„ μ μμµλ‹λ‹¤.

## ν”„λ΅μ νΈ κµ¬μ΅°

```
server-health-check/
β”β”€β”€ app/
β”‚   β”β”€β”€ api/
β”‚   β”‚   β”β”€β”€ endpoints/
β”‚   β”‚   β”‚   β””β”€β”€ route.js          # μ—”λ“ν¬μΈνΈ λ©λ΅ API (μ„λ²„ μ‚¬μ΄λ“)
β”‚   β”‚   β””β”€β”€ slack/
β”‚   β”‚       β””β”€β”€ route.js          # μ¬λ™ μ•λ¦Ό API Route (μ„λ²„ μ‚¬μ΄λ“)
β”‚   β”β”€β”€ layout.js                 # λ£¨νΈ λ μ΄μ•„μ›ƒ
β”‚   β”β”€β”€ page.js                   # λ©”μΈ νμ΄μ§€
β”‚   β””β”€β”€ globals.css               # μ „μ—­ μ¤νƒ€μΌ
β”β”€β”€ components/
β”‚   β”β”€β”€ HealthCheckMonitor.js     # ν—¬μ¤μ²΄ν¬ λ¨λ‹ν„° μ»΄ν¬λ„νΈ (ν΄λΌμ΄μ–ΈνΈ)
β”‚   β””β”€β”€ HealthCheckMonitor.css
β”β”€β”€ services/
β”‚   β””β”€β”€ healthCheckService.js     # ν—¬μ¤μ²΄ν¬ λ΅μ§
β””β”€β”€ .env.local                     # ν™κ²½ λ³€μ (μ„λ²„ μ‚¬μ΄λ“)
```

## λ³΄μ• κ°μ„ μ‚¬ν•­

- β… μ¬λ™ μ›Ήν›… URLμ΄ μ„λ²„ μ‚¬μ΄λ“μ—μ„λ§ μ ‘κ·Ό κ°€λ¥
- β… ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— λ―Όκ°ν• μ •λ³΄ λ…Έμ¶ λ°©μ§€
- β… Next.js API Routesλ¥Ό ν†µν• μ•μ „ν• μ„λ²„ ν†µμ‹ 

## λΉλ“

ν”„λ΅λ•μ… λΉλ“λ¥Ό μƒμ„±ν•λ ¤λ©΄:

```bash
npm run build
npm start
```

λΉλ“λ νμΌμ€ `.next` ν΄λ”μ— μƒμ„±λ©λ‹λ‹¤.

## κΈ°μ  μ¤νƒ

- Next.js 14 (App Router)
- React 18
- Axios (HTTP ν΄λΌμ΄μ–ΈνΈ)

## λΌμ΄μ„ μ¤

MIT

